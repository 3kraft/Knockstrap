/*! knockstrap 0.3.0 | (c) 2013 Artem Stepanyuk |  http://www.opensource.org/licenses/mit-license */
!function(a,b){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?b(require("knockout"),require("jquery")):"function"==typeof define&&define.amd?define(a,["knockout","jQuery"],b):b(ko,$)}("knockstrap",function(a,b){a.utils.uniqueId=function(){var a={"ks-unique-":0};return function(b){return b=b||"ks-unique-",a[b]||(a[b]=0),b+a[b]++}}(),a.utils.unwrapProperties=function(b){var c={};return a.utils.objectForEach(b,function(b,d){c[b]=a.unwrap(d)}),c},a.stringTemplateEngine=function(){var b={},c=new a.nativeTemplateEngine;return b.alert='<div class="alert alert-block fade in" data-bind="css: type"> <button class="close" data-bind="click: close" aria-hidden="true">&times;</button> <p data-bind="text: message"></p> </div>',b.carousel='<!-- ko template: indicatorsTemplate --> <!-- /ko --> <div class="carousel-inner"> <!-- ko foreach: items --> <div class="item" data-bind="with: $parent.converter($data), css: { active: $index() == 0 }"> <img data-bind="attr: { src: src, alt: alt }"> <div class="container"> <div class="carousel-caption"> <!-- ko template: { name: $parents[1].itemTemplateName, data: $data, templateEngine: $parents[1].templateEngine } --> <!-- /ko --> </div> </div> </div> <!-- /ko --> </div> <!-- ko template: controlsTemplate --> <!-- /ko --> ',b.carouselContent='<div data-bind="text: content"></div>',b.carouselControls='<a class="left carousel-control" data-bind="attr: { href: id }" data-slide="prev"> <span class="icon-prev"></span> </a> <a class="right carousel-control" data-bind="attr: { href: id }" data-slide="next"> <span class="icon-next"></span> </a>',b.carouselIndicators='<ol class="carousel-indicators" data-bind="foreach: items"> <li data-bind="attr: { \'data-target\': $parent.id, \'data-slide-to\': $index }"></li> </ol> ',b.modal='<div class="modal-dialog"> <div class="modal-content"> <div class="modal-header" data-bind="template: headerTemplate"> </div> <div class="modal-body" data-bind="template: bodyTemplate"> </div> <div class="modal-footer" data-bind="template: footerTemplate"> </div> </div> </div>',b.modalBody='<div data-bind="html: content"> </div>',b.modalFooter='<a href="#" class="btn btn-primary" data-bind="click: action, html: primaryLabel"></a> <a href="#" class="btn btn-default" data-bind="html: closeLabel" data-dismiss="modal"></a>',b.modalHeader='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h3 data-bind="text: label"></h3> ',b.progress='<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" data-bind="style: { width: barWidth }, attr: { \'aria-valuenow\' : value }"> <span class="sr-only"><span data-bind="text: value"></span>% Complete</span> </div> ',a.templateSources.stringTemplate=function(a){this.templateName=a,this.data=function(a,c){return b.data=this.templates.data||{},b.data[this.templateName]=this.templates.data[this.templateName]||{},1===arguments.length?b.data[this.templateName][a]:(b.data[this.templateName][a]=c,void 0)},this.text=function(a){return 0===arguments.length?b[this.templateName]:(b[this.templateName]=a,void 0)}},c.makeTemplateSource=function(b){return new a.templateSources.stringTemplate(b)},c.addTemplate=function(a,c){b[a]=c},c},a.stringTemplateEngine.instance=new a.stringTemplateEngine,a.bindingHandlers.alert={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c,d,e,f){var g=c(),h=g.template?null:a.stringTemplateEngine.instance,i=a.unwrap(g.template)||"alert",j=g.data||{message:g.message,type:a.computed(function(){return"alert-"+(a.unwrap(g.type)||"info")}),close:g.close||function(){a.virtualElements.emptyNode(b)}};a.renderTemplate(i,f.createChildContext(j),a.utils.extend({templateEngine:h},g.templateOptions),b)}},a.virtualElements.allowedBindings.alert=!0,a.bindingHandlers.carousel={defaults:{controlsTemplate:{name:"carouselControls",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)})}}},indicatorsTemplate:{name:"carouselIndicators",templateEngine:a.stringTemplateEngine.instance,dataConverter:function(b){return{id:a.computed(function(){return"#"+a.unwrap(b.id)}),items:b.content.data}}},itemTemplate:{name:"carouselContent",templateEngine:a.stringTemplateEngine.instance,converter:function(a){return a}}},init:function(c,d,e,f,g){var h=b(c),i=d(),j=a.bindingHandlers.carousel.defaults,k=function(c,d){var e={name:c.name,data:i.data||i[d]&&i[d].dataConverter&&i[d].dataConverter(i)||c.dataConverter(i),templateEngine:a.stringTemplateEngine.instance};return b.extend(!0,e,i[d]),i[d]&&i[d].name||(e.templateEngine=a.stringTemplateEngine.instance),e};if(!i.content)throw new Error("content option is required for carousel binding");c.id=c.id||a.unwrap(i.id)||a.utils.uniqueId("ks-carousel-"),i.id||(i.id=c.id);var l={id:i.id,controlsTemplate:k(j.controlsTemplate,"controls"),indicatorsTemplate:k(j.indicatorsTemplate,"indicators"),items:i.content.data,converter:i.content.converter||j.itemTemplate.converter,itemTemplateName:i.content.name||j.itemTemplate.name,templateEngine:i.content.name?null:a.stringTemplateEngine.instance};return a.renderTemplate("carousel",g.createChildContext(l),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass("carousel slide"),{controlsDescendantBindings:!0}},update:function(c,d){var e=b(c),f=d(),g=a.unwrap(f.options);e.carousel(g)}},a.bindingHandlers.checkbox={init:function(c,d){var e=b(c),f=function(c){setTimeout(function(){var e=b(c.target),f=d(),g=e.val(),h=e.parent().hasClass("active");if(a.unwrap(f)instanceof Array){var i=a.unwrap(f).indexOf(g);h&&-1===i?f.push(g):h||-1===i||f.splice(i,1)}else f(h)},0)};if("buttons"===e.attr("data-toggle")&&e.find("input:checkbox").length)e.on("change","input:checkbox",f);else{if("checkbox"!==e.attr("type"))throw new Error("checkbox binding should be used only with bootstrap checkboxes");e.on("change",f)}},update:function(c,d){var e=b(c),f=a.unwrap(d());f instanceof Array?"buttons"===e.attr("data-toggle")?e.find("input:checkbox").each(function(a,c){b(c).parent().toggleClass("active",-1!==f.indexOf(c.value))}):e.toggleClass("active",-1!==f.indexOf(e.val())):e.parent().toggleClass("active",!!f)}},a.bindingHandlers.modal={defaults:{headerTemplate:{name:"modalHeader"},bodyTemplate:{name:"modalBody"},footerTemplate:{name:"modalFooter",data:{closeLabel:"Close",primaryLabel:"Ok"}}},init:function(c,d,e,f,g){var h=b(c),i=a.unwrap(d()),j=a.bindingHandlers.modal.defaults,k=a.utils.extend({show:!1},a.utils.unwrapProperties(i.options));if(!i.header||!i.body||!i.footer)throw new Error("header, body and footer options are required for modal binding.");var l={headerTemplate:b.extend(!0,{templateEngine:i.header.name?null:a.stringTemplateEngine.instance},j.headerTemplate,i.header),bodyTemplate:b.extend(!0,{templateEngine:i.body.name?null:a.stringTemplateEngine.instance},j.bodyTemplate,i.body),footerTemplate:b.extend(!0,{templateEngine:i.footer.name?null:a.stringTemplateEngine.instance},j.footerTemplate,i.footer)};return a.renderTemplate("modal",g.createChildContext(l),{templateEngine:a.stringTemplateEngine.instance},c),h.addClass("modal fade").attr("role","dialog"),h.modal(k),h.on("shown.bs.modal",function(){i.visible(!0)}),h.on("hidden.bs.modal",function(){i.visible(!1)}),{controlsDescendantBindings:!0}},update:function(c,d){var e=a.unwrap(d());b(c).modal(a.unwrap(e.visible)?"show":"hide")}};var c="__popoverTemplateKey__",d="__popoverEventHandlerKey__";a.bindingHandlers.popover={init:function(c){var d=b(c);return a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.popover")&&d.popover("destroy")}),{controlsDescendantBindings:!0}},update:function(e,f,g,h,i){var j=b(e),k=a.unwrap(f()),l=k.options||k.template?a.utils.unwrapProperties(k.options):a.utils.unwrapProperties(k);if(k.template){var m=a.unwrap(k.template),n=a.utils.domData.get(e,c),o=a.unwrap(k.data);n||(n=a.utils.uniqueId("ks-popover-"),a.utils.domData.set(e,c,n)),j.off("shown.bs.popover",a.utils.domData.get(e,d));var p=function(){a.renderTemplate(m,i.createChildContext(o),{},document.getElementById(n))};j.on("shown.bs.popover",p),a.utils.domData.set(e,d,p),l.content='<div id="'+n+'" ></div>',l.html=!0,b(n).is(":visible")&&p()}var q=j.data("bs.popover");q?a.utils.extend(q.options,l):j.popover(l)}},a.bindingHandlers.progress={init:function(c,d){var e=b(c),f=d(),g=a.computed(function(){return a.unwrap(f)+"%"});return a.renderTemplate("progress",{value:f,barWidth:g},{templateEngine:a.stringTemplateEngine.instance},c),e.addClass("progress"),{controlsDescendantBindings:!0}}},a.bindingHandlers.radio={init:function(a,c){var d=b(a);d.on("change","input:radio",function(a){setTimeout(function(){var d=b(a.target),e=c(),f=d.val();e(f)},0)})},update:function(c,d){var e=b(c).find('input[value="'+a.unwrap(d())+'"]'),f=e.parent();e.length&&(f.siblings().removeClass("active"),f.addClass("active"),e[0].checked=!0)}},a.bindingHandlers.toggle={init:function(b,c){var d=c();a.utils.registerEventHandler(b,"click",function(){var b=a.unwrap(d);d(!b)})},update:function(b,c){a.utils.toggleDomNodeCssClass(b,"active",a.unwrap(c()))}},a.bindingHandlers.tooltip={init:function(c){var d=b(c);a.utils.domNodeDisposal.addDisposeCallback(c,function(){d.data("bs.tooltip")&&d.tooltip("destroy")})},update:function(c,d){var e=b(c),f=a.unwrap(d()),g=a.utils.unwrapProperties(f),h=e.data("bs.tooltip");h?a.utils.extend(h.options,g):e.tooltip(g)}}});